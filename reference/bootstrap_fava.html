<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Statistically compare FAVA values between pairs of relative abundance matrices. — bootstrap_fava • FAVA</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Statistically compare FAVA values between pairs of relative abundance matrices. — bootstrap_fava"><meta name="description" content="bootstrap_fava uses bootstrapping to statistically compare FAVA values between pairs of relative abundance matrices. bootstrap_fava takes the same options as fava, so, as with fava, you can separately analyze multiple populations or groups of samples (specify group), and account for similarity among categories (specify S) or uneven weighting of rows (specify w or time). bootstrap_fava follows the bootstrapping procedure defined by Efron and Tibshirani (1993). Details on the bootstrapping procedure are available in the Methods section of the accompanying paper."><meta property="og:description" content="bootstrap_fava uses bootstrapping to statistically compare FAVA values between pairs of relative abundance matrices. bootstrap_fava takes the same options as fava, so, as with fava, you can separately analyze multiple populations or groups of samples (specify group), and account for similarity among categories (specify S) or uneven weighting of rows (specify w or time). bootstrap_fava follows the bootstrapping procedure defined by Efron and Tibshirani (1993). Details on the bootstrapping procedure are available in the Methods section of the accompanying paper."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">FAVA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MaikeMorrison/FAVA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Statistically compare FAVA values between pairs of relative abundance matrices.</h1>
      <small class="dont-index">Source: <a href="https://github.com/MaikeMorrison/FAVA/blob/master/R/boostrap_comparison.R" class="external-link"><code>R/boostrap_comparison.R</code></a></small>
      <div class="d-none name"><code>bootstrap_fava.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>bootstrap_fava</code> uses bootstrapping to statistically compare FAVA values between pairs of relative abundance matrices. <code>bootstrap_fava</code> takes the same options as <code>fava</code>, so, as with <code>fava</code>, you can separately analyze multiple populations or groups of samples (specify <code>group</code>), and account for similarity among categories (specify <code>S</code>) or uneven weighting of rows (specify <code>w</code> or <code>time</code>). <code>bootstrap_fava</code> follows the bootstrapping procedure defined by Efron and Tibshirani (1993). Details on the bootstrapping procedure are available in the Methods section of the accompanying paper.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bootstrap_fava</span><span class="op">(</span></span>
<span>  <span class="va">relab_matrix</span>,</span>
<span>  n_replicates <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  <span class="va">group</span>,</span>
<span>  K <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  S <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  w <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  time <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  normalized <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alternative <span class="op">=</span> <span class="st">"two.sided"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-relab-matrix">relab_matrix<a class="anchor" aria-label="anchor" href="#arg-relab-matrix"></a></dt>
<dd><p>A matrix or data frame with rows containing non-negative entries that sum to 1. Each row represents a sample, each column represents a category, and each entry represents the abundance of that category in the sample. If <code>relab_matrix</code> contains any metadata, it must be on the left-hand side of the matrix, the right <code>K</code> entries of each row must sum to 1, and <code>K</code> must be specified. Otherwise, all entries of each row must sum to 1.</p></dd>


<dt id="arg-n-replicates">n_replicates<a class="anchor" aria-label="anchor" href="#arg-n-replicates"></a></dt>
<dd><p>The number of bootstrap replicate matrices to generate. Default is <code>n_replicates = 1000</code>.</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>A string (or vector of strings) specifying the name(s) of the column(s) that describes which group(s) each row (sample) belongs to. Use if <code>relab_matrix</code> is a single matrix containing multiple groups of samples you wish to compare.</p></dd>


<dt id="arg-k">K<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>Optional; an integer specifying the number of categories in the data. Default is <code>K=ncol(relab_matrix)</code>.</p></dd>


<dt id="arg-s">S<a class="anchor" aria-label="anchor" href="#arg-s"></a></dt>
<dd><p>Optional; a K x K similarity matrix with diagonal elements equal to 1 and off-diagonal elements between 0 and 1. Entry <code>S[i,k]</code> for <code>i!=k</code> is the similarity between category and <code>i</code> and category <code>k</code>, equaling 1 if the categories are to be treated as identical and equaling 0 if they are to be treated as totally dissimilar. The default value is <code>S = diag(ncol(relab_matrix))</code>.</p></dd>


<dt id="arg-w">w<a class="anchor" aria-label="anchor" href="#arg-w"></a></dt>
<dd><p>Optional; a vector of length <code>I</code> with non-negative entries that sum to 1. Entry <code>w[i]</code> represents the weight placed on row <code>i</code> in the computation of the mean abundance of each category across rows. The default value is <code>w = rep(1/nrow(relab_matrix), nrow(relab_matrix))</code>.</p></dd>


<dt id="arg-time">time<a class="anchor" aria-label="anchor" href="#arg-time"></a></dt>
<dd><p>Optional; a string specifying the name of the column that describes the sampling time for each row. Include if you wish to weight FAVA by the distance between samples.</p></dd>


<dt id="arg-normalized">normalized<a class="anchor" aria-label="anchor" href="#arg-normalized"></a></dt>
<dd><p>Optional; should normalized FAVA be used? Default is <code>normalized = FALSE</code>; use <code>normalized = TRUE</code> to compute normalized FAVA. FAVA can only be normalized if it is not weighted.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Optional; an integer to be used as a random seed for the simulations.</p></dd>


<dt id="arg-alternative">alternative<a class="anchor" aria-label="anchor" href="#arg-alternative"></a></dt>
<dd><p>Optional; do you want to do a one- or two.sided test? Default is <code>alternative = "two.sided"</code>. If you wish to do a one-sided test, specify either <code>alternative = "lesser"</code> or <code>alternative = "greater"</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A named list containing the following entries:</p><ul><li><p><code>p_values</code>: The probability of observing the observed difference in variability between each pair of groups if there were no difference between groups. Computed as the fraction of bootstrap differences greater than or equal to the observed difference. Depends on what <code>alternative</code> is specified ("greater", "lesser", or "two.sided").</p></li>
<li><p><code>bootstrap_distribution_plot</code>: The distribution of bootstrap replicate differences in each variability value. The observed differences are shown in red. The further the red points are from 0, the more significant the statistical difference between groups.</p></li>
<li><p><code>observed_stats</code>: The observed diversity statistics for the groups.</p></li>
<li><p><code>bootstrap_stats</code>: The bootstrap replicate diversity statistics for the groups.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Statistically compare values of FAVA between</span></span></span>
<span class="r-in"><span><span class="co"># subjects in the xue_microbiome_sample data:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">boot_out</span> <span class="op">=</span> <span class="fu">bootstrap_fava</span><span class="op">(</span>relab_matrix <span class="op">=</span> <span class="va">xue_microbiome_sample</span>,</span></span>
<span class="r-in"><span>               n_replicates <span class="op">=</span> <span class="fl">20</span>, <span class="co"># should use 1000 for a real analysis</span></span></span>
<span class="r-in"><span>               seed <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>               group <span class="op">=</span> <span class="st">"subject"</span>,</span></span>
<span class="r-in"><span>               K <span class="op">=</span> <span class="fl">524</span>,</span></span>
<span class="r-in"><span>               S <span class="op">=</span> <span class="va">xue_species_similarity</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Table of P-values comparing values of FAVA between group 1 and group 2:</span></span></span>
<span class="r-in"><span> <span class="va">boot_out</span><span class="op">$</span><span class="va">P_values</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Comparison P_value P_value_numeric</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  XBA - XDA     0.6            0.60</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  XBA - XMA    0.05            0.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  XDA - XMA   &lt;0.05            0.00</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># Plots of the bootstrap distributions of differences in FAVA between each pair of matrices,</span></span></span>
<span class="r-in"><span> <span class="co"># and how the true observed differences (red dots) compare to the distribution.</span></span></span>
<span class="r-in"><span> <span class="va">boot_out</span><span class="op">$</span><span class="va">bootstrap_distribution_plot</span></span></span>
<span class="r-plt img"><img src="bootstrap_fava-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Maike Morrison.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

